Bom dia Ivo, 

Testei e vou colocar em Produção, porém quando puder por favor acrescente na validação abaixo a 
sub-serie, pois as vezes é a única coisa que muda de uma fatura para outra e ai na próxima alteração 
que bfizermos já sobe com essa alteração. 


      DECLARE cq_pri_ad CURSOR FOR
      SELECT num_ad, num_nf, ser_nf, ssr_nf 
        FROM ad_mestre
       WHERE cod_empresa = p_cod_empresa
         AND num_nf = l_num_nf
         AND ser_nf = mr_nota.ser_nf
         AND cod_fornecedor = mr_nota.cod_fornecedor
         AND dat_venc = m_dat_vencto
         AND val_tot_nf  = mr_nota.val_tot_nf
