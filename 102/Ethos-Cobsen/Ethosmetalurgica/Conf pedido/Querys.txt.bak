
select * from tran_arg where data_proc = '13/02/2020'
select * from prog_efetivada_547 where dat_proces = '13/02/2020'
select * from min_par_modulo where empresa = '01' and parametro like 'QTD_DIAS_ITEM%' -- tempo minimo para pedido

select * from semana_sup
select * from ethosm_fer_prz
select first 100 * from ethos_edi_pedidos
select first 10 * from item_kanban_547 *
select first 100 * from pedidos
select first 100 * from ped_itens_ethos *
select first 100 * from info_tecnicas -- des_inf_tecnica (capacidade de produção diaria)
select first 100 * from ethosm_grupo_dia
select first 100 * from ethosm_ite_emb
select first 100 * from ethos_edi_div_ped
select first 100 * from ethos_edi_opeprazo
select first 100 * from ethos_edi_seq_virt_pri
select first 100 * from ethos_edi_opepratm

ped_itens
item
clientes
cliente_item
item_man
item_embalagem
estrutura
consumo
operacao


sql = " select a.num_pedido pedido,      " _
       & "        j.num_sequencia num_seq, " _
       & "        f.cod_item_cliente, " _
       & "        a.cod_item, " _
       & "        k.cod_etapa tamanho, " _
       & "        c.den_item_reduz, " _
       & "        a.dat_proces carregado, " _
       & "        j.prz_entrega abertura, " _
       & "        g.ship_date, " _
       & "        a.qtd_aceita, " _
       & "        a.sit_programa, " _
       & "        case " _
       & "        when h.tipo_item Is Not Null " _
       & "        then trim(h.tipo_item)||'-'||cast(h.qtd_dias as decimal(10,0))||' DIAS' " _
       & "        else b.num_pedido_cli [1,2] " _
       & "        end tipo_pedido, " _
       & "        case " _
       & "        when h.tipo_item Is Not Null " _
       & "        then cast(h.qtd_dias as decimal(10,0)) " _
       & "        else cast(i.parametro_numerico as decimal(10,0)) " _
       & "        end dias_padrao_tipo, " _
       & "        a.rowid reg_log, "
  
  sql0 = "        case " _
       & "        when e.num_pedido Is Not Null " _
       & "        then 'SIM' " _
       & "        else '   ' " _
       & "        end amostra, " _
       & "        d.nom_reduzido cliente " _
       & "   from prog_efetivada_547 a " _
       & "   join pedidos b " _
       & "     on (a.cod_empresa = b.cod_empresa) " _
       & "    and (a.num_pedido  = b.num_pedido) " _
       & "   join ped_itens j " _
       & "     on (a.cod_empresa   = j.cod_empresa) " _
       & "    and (a.num_pedido    = j.num_pedido) " _
       & "    and (a.prz_entrega   = j.prz_entrega) " _
       & "    and (a.cod_item      = j.cod_item) "
       
  sql1 = "   left join ped_itens_ethos g                 " _
       & "          on (a.cod_empresa   = g.cod_empresa) " _
       & "         and (a.num_pedido    = g.num_pedido) " _
       & "         and (j.num_sequencia = g.num_sequencia) " _
       & "   left join item c " _
       & "          on (a.cod_empresa = c.cod_empresa) " _
       & "         and (a.cod_item    = c.cod_item) " _
       & "   left join ped_itens_texto e " _
       & "          on (a.cod_empresa = e.cod_empresa) " _
       & "         and (a.num_pedido  = e.num_pedido) " _
       & "         and (e.den_texto_1 like '%AMOSTRA%') " _
       & "   left join clientes d " _
       & "          on (b.cod_cliente          = d.cod_cliente) " _
       & "   left join cliente_item f " _
       & "          on (a.cod_empresa          = f.cod_empresa) " _
       & "         and (b.cod_cliente          = f.cod_cliente_matriz) " _
       & "         and (a.cod_item             = f.cod_item) "

  sql2 = "   left join item_kanban_547 h " _
       & "          on (a.cod_empresa          = h.cod_empresa) " _
       & "         and (a.cod_item             = h.cod_item) " _
       & "         and (f.cod_item_cliente     = h.cod_item_cliente) " _
       & "         and (h.dat_inicio          <= today) " _
       & "         and (h.dat_termino         >= today) " _
       & "   left join item_man k                       " _
       & "          on (a.cod_empresa          = k.cod_empresa) " _
       & "         and (a.cod_item             = k.cod_item)  " _
       & "   left join min_par_modulo i " _
       & "          on (a.cod_empresa          = i.empresa) " _
       & "         and (i.parametro         like '%'||b.num_pedido_cli[1,2]||'%') " _
       & "     where a.cod_empresa = '" & selemp & "'                            " _
       & "       and a.dat_proces  = '" & Format(Me.data_edi, "dd/mm/yyyy") & "' " _
       & "     order by 1,2 "
'tratamento item em duplicidade pelo ship date
   
   If Not (IsNull(Format(data_base, "dd/mm/yyyy"))) Then
      sql = "set isolation to dirty read "
      
      If (cpd.State) <> adStateClosed Then cpd.Close
      telacorr = DoEvents
      cpd.Open sql, connOnLine, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.adLockReadOnly
      telacorr = DoEvents
   
      sql = "select         x3.cod_item_cliente, " _
          & "               x1.ship_date,        " _
          & "               x0.num_pedido,       " _
          & "               x0.num_sequencia,    " _
          & "               x0.prz_entrega,      " _
          & "              (x0.qtd_pecas_solic - x0.qtd_pecas_atend - x0.qtd_pecas_cancel) saldo_pc " _
          & "  from ped_itens             x0     " _
          & "  left join ped_itens_ethos  x1     " _
          & "    on (x0.cod_empresa   = x1.cod_empresa)   " _
          & "   and (x0.num_pedido    = x1.num_pedido)    " _
          & "   and (x0.num_sequencia = x1.num_sequencia) " _
          & "  left join pedidos          x2              " _
         & "    on (x0.cod_empresa   = x2.cod_empresa)   " _
          & "   and (x0.num_pedido    = x2.num_pedido)    " _
          & "  left join cliente_item     x3              " _
          & "    on (x0.cod_empresa   = x3.cod_empresa)   " _
          & "   and (x2.cod_cliente   = x3.cod_cliente_matriz) " _
          & "   and (x0.cod_item      = x3.cod_item)           " _
          & " where x0.cod_empresa       = '" & selemp & "' " _
          & "   and x1.ship_date         = '" & Format(data_base, "dd/mm/yyyy") & "' " _
          & "   and (x0.qtd_pecas_solic - x0.qtd_pecas_atend - x0.qtd_pecas_cancel) > 0 " _
          & "   and (x3.cod_item_cliente = '" & Trim(edi.Fields("cod_item_cliente")) & "' " _
          & "    or  x3.cod_item         = '" & Trim(edi.Fields("cod_item")) & "') "
' tratamento da divergencia qtde produzida dia do item
   sql = "set isolation to dirty read "
   
   If (cpd.State) <> adStateClosed Then cpd.Close
   telacorr = DoEvents
   cpd.Open sql, connOnLine, ADODB.CursorTypeEnum.adOpenDynamic, ADODB.adLockReadOnly
   telacorr = DoEvents

   sql = " select cast(des_inf_tecnica as decimal(17,3)) qtde_prod_dia  " _
       & "   from info_tecnicas  " _
       & " where cod_empresa      = '" & selemp & "' " _
       & "   and cod_compon       = '" & Trim(edi.Fields("cod_item")) & "' " _
       & "   and cod_pdr_info_tec = 994 " _
       & "   and num_seq          = 1 "
